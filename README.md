# Sentiment analysis with Keras

Чтобы начать работать с репозиторием, запустите ```./setup.sh```.

В этом репозитории проводится сравнение векторных моделей представления слов в задаче анализа тональности русскоязычных текстов. Исходные данные для обучения взяты из открытого источника - http://study.mokoron.com/ (Ю. В. Рубцова. Построение корпуса текстов для настройки тонового классификатора // Программные продукты и системы, 2015, №1(109), –С.72-78)

## Что тут вообще происходит?
Первый метод взят из исходного туториала - обучение эмбеддингов во время обучения сверточной нейросети-классификатора.
Базовый конвейер - удаление стоп-слов, обработка отрицаний (?), лемматизация, токенизация, обучение векторного представления из списка, трансформация данных в соответствии с векторным представлением, создание и обучение нейросети с рекуррентными слоями LSTM, валидация результатов.

Загруженные предобученные word embeddings - https://nlpub.ru/Russian_Distributional_Thesaurus

## Файлы
1. Предобработка данных data_preprocessing.ipynb
2. Базовый конвейер basic_solution.ipynb
3. А дальше - как пойдет. Нужно оформить как библиотеку

#### P.S. Неплохо бы еще веб-морду сделать для презентабельного вида

## Описание конвейера
1. Исходные данные - два файла с твитами, обогащенные доп информацией и разметкой тональности (1 - положительная, -1 - отрицательная). Данные перемешиваются рандомом; 1 и -1 заменяется на 1 для положительного сообщения, а 0 для отрицательного;  текст переведен в нижний регистр; данные режутся на train, test, val выборки и сохраняются в отдельные файлы.

2. Стоп-слова. 
	- убраны упоминания, хэштеги, метки ретвитов, ссылки;
	- символы оставить, это могут быть смайлы - эмоционально окрашенные элементы. Поэтому пришлось отказаться от Tokenizer из keras.preprocessing.text. Он по умолчанию удаляет все символы, переводит в нижний регистр (сделано вручную)

3. PyStemmer — стемминг в Python 
Простая, удобная, быстрая библиотека для нахождения основ или стемминга русских слов. http://snowball.tartarus.org/algorithms/russian/stemmer.html
Возможно, пригодится морфологизация https://pymorphy2.readthedocs.io/en/latest/#
Морфологический анализатор pymorphy2 написан на языке Python (работает под 2.7 и 3.3+). Он умеет:
- приводить слово к нормальной форме (например, “люди -> человек”, или “гулял -> гулять”).
- ставить слово в нужную форму. Например, ставить слово во множественное число, менять падеж слова и т.д.
- возвращать грамматическую информацию о слове (число, род, падеж, часть речи и т.д.)

https://pypi.python.org/pypi/PyStemmer/1.3.0

Из слов “коврики”, “ковриков”, “коврика” — получится “коврик”.

Пользоваться очень просто:

>>> import Stemmer
>>> stemmer = Stemmer.Stemmer('russian')
>>> stemmer.stemWord('ковриков')
коврик

>>> stemmer.stemWords(['топора', u'молотков'])
['топор', 'молотк']
 